---
title: "Project memo"
author: "ADA"
output: github_document
---

This document should contain a detailed account of the data clean up for your data and the design choices you are making for your plots. For instance you will want to document choices you've made that were intentional for your graphic, e.g. color you've chosen for the plot. Think of this document as a code script someone can follow to reproduce the data cleaning steps and graphics in your handout.

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(skimr)
```

## Data Clean Up Steps for Overall Data

### Step 1: Cleaning both data sets

```{r clean-demographic}
demographic_clean <- demographic %>%
  # ensure Group is character 
  mutate(Group = as.character(Group)) %>%
  
  # convert only columns that actually contain "%" into numeric
  mutate(across(
    .cols = where(~ any(grepl("%", .x, fixed = TRUE), na.rm = TRUE)),
    .fns  = ~ as.numeric(gsub("%", "", .x))
  )) %>%
  
  # create gender and race columns
  mutate(
    gender = case_when(
      Group %in% c("Men", "Women") ~ Group,
      TRUE ~ NA_character_
    ),
    race = case_when(
      Group %in% c("White", "Black", "Hispanic", "Asian") ~ Group,
      TRUE ~ NA_character_
    )
  ) %>%
  
  # reshape to long format
  pivot_longer(
    cols = -c(Group, gender, race),
    names_to  = "platform",
    values_to = "percent"
  ) %>%
  filter(!is.na(platform)) 

```

```{r clean-social}
social_clean <- social %>%
  mutate(across(where(is.character), 
                ~ as.numeric(ifelse(is.na(.), NA, gsub("%", "", .))))) %>%
  
  # Keep year column, rename if needed
  rename(date = Year) %>%
  
  # Reshape to long format
  pivot_longer(
    cols = -date,
    names_to = "platform",
    values_to = "percent"
  ) %>%
  mutate(year = lubridate::year(lubridate::mdy(date)))
```

### Step 2: Visualization for presentation on 11/13

## Plots

### ggsave example for saving plots

```{r starwars ggsave example}
p1 <- starwars |>
  filter(mass < 1000, 
         species %in% c("Human", "Cerean", "Pau'an", "Droid", "Gungan")) |>
  ggplot() +
  geom_point(aes(x = mass, 
                 y = height, 
                 color = species)) +
  labs(x = "Weight (kg)", 
       y = "Height (m)",
       color = "Species",
       title = "Weight and Height of Select Starwars Species",
       caption = paste("This data comes from the starwars api: https://swapi.py43.com"))


ggsave("example-starwars.png", width = 4, height = 4)

ggsave("example-starwars-wide.png", width = 6, height = 4)
```



### Plot 1: Platform Usage by Race

#### Data cleanup steps specific to plot 1

These data cleaning sections are optional and depend on if you have some data cleaning steps specific to a particular plot

```{r}

```


#### Final Plot 1

```{r platform-usage-by-race, fig.alt = "Faceted bar chart showing social media usage by platform and race. Each facet represents a platform, the x-axis shows racial groups, the y-axis shows usage percentages, bars are colored by race, and labels on each bar show exact percentages. The purpose is to compare differences in platform engagement across racial groups among U.S. adults."}

cb_palette <- c(
  "Asian" = "#0072B2",
  "Black" = "#E69F00",
  "Hispanic" = "#009E73",
  "White" = "#D55E00",
  "Other" = "#CC79A7"
)

ggplot(demographic_clean %>% filter(!is.na(race)),
       aes(x = race, y = percent, fill = race)) +
  
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +

  geom_text(
    aes(label = percent),
    position = position_dodge(width = 0.9),
    vjust = -0.3,
    size = 1.8
  ) +
  
  labs(
    title = "Social Media Usage by Platform and Race",
    subtitle = "Data obtained through a survey of adults across the US",
    x = "Race",
    y = "Usage (%)"
  ) +
  
  scale_fill_manual(values = cb_palette) +
  
  facet_wrap(~ platform, nrow = 3) +
  
  scale_y_continuous(
    limits = c(0, 100),
    expand = expansion(mult = c(0, 0.07))
  ) +
  
  theme_minimal(base_size = 10) +
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank(),
    
    panel.grid.major.y = element_line(color = "gray80"),
    panel.grid.minor = element_blank(),
    
    axis.text.x = element_text(size = 8, angle = 45, hjust = 1),

    plot.title = element_text(face = "bold", size = 12, hjust = 0.5),
    plot.subtitle = element_text(size = 8, hjust = 0.5, margin = margin(b = 8)),

    legend.position = "none"
  )

ggsave("platform-by-race.png", width = 4, height = 4)

```


### Plot 2: Platform Usage by Gender

```{r platform-usage-by-gender, fig.alt = "Faceted bar chart showing social media usage by platform and gender. Each facet represents a platform, the x-axis shows men and women, the y-axis shows usage percentages, bars are colored by gender, and labels above each bar display exact usage values. The chart highlights differences in how men and women use social media platforms across adults in the United States."}

# compute female usage for each platform 
female_usage <- demographic_clean %>%
  filter(gender == "Women") %>%
  select(platform, female_percent = percent)

# join back + reorder platform factor by female usage 
demographic_sorted <- demographic_clean %>%
  left_join(female_usage, by = "platform") %>%
  mutate(platform = reorder(platform, female_percent))

ggplot(demographic_sorted %>% filter(!is.na(gender)),
       aes(x = gender, y = percent, fill = gender)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
  geom_text(
    aes(label = percent),
    position = position_dodge(width = 0.9),
    vjust = -0.3,
    size = 2.5
  ) +
  scale_fill_manual(values = c("Men" = "#0072B2", "Women" = "#CC79A7")) +
  scale_y_continuous(
    breaks = c(0, 25, 50, 75, 100),
    limits = c(0, 100),
    expand = expansion(mult = c(0, 0.05))
  ) +
  labs(
    title = "Social Media Usage by Platform and Gender",
    subtitle = "Data obtained through a survey of adults across the US",
    x = "Gender",
    y = "Usage (%)"
  ) +
  facet_wrap(~ platform, nrow = 3) +
  theme_minimal(base_size = 10) +
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank(),
    panel.border = element_blank(),
    panel.grid.major.y = element_line(color = "gray80"),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 8),
    plot.title = element_text(face = "bold", size = 15, hjust = 0.5),
    plot.subtitle = element_text(size = 8, hjust = 0.5, margin = margin(b = 8)),
    legend.position = "none"
  )

ggsave("platform-by-gender-facet.png", width = 4, height = 4)

```

### Plot 3: ___________

Add more plot sections as needed. Each project should have at least 3 plots, but talk to me if you have fewer than 3.

### Plot 4: ___________ 

